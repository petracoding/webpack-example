**Webpack** takes all your files (e.g. multiple javascript files, css files, scss files, fonts, images, etc.), crumples them up into one big ball, and spits them out again. You're left with - in many cases - just one, big file that contains all your css and javascript code, which you can neatly load in your html files.

**Why use it?** Well, because once you have more than just a few lines of javascript code it gets really messy; you'd have to import all of the files in exactly the right order. It also makes it much easier to split up CSS into multiple files, and makes it possible to use SCSS (which Webpack automatically turns into CSS for you)!

Don't be discouraged by the long and frankly confusing set up. Not only will this teach you valuable skills (such as working with terminal commands), but it's also time you will save yourself later once the set up is complete and you start coding.

I've tried to make the tutorial as simple yet easy-to-follow as possible. If anything is unclear, don't be afraid to ask. (Trust me, I know the frustration that comes with trying to understand Webpack as a beginner; you don't need to be ashamed.)

You can find the files/codes for this entire example project [HERE](TODO). Please note that simply copying the contents of those files is _not_ the same as installing webpack. You will still need to run the installation commands, for example. Therefore, I provide the files not for you to copy, but as a quick reference and comparision tool for you as you go through this tutorial on your own.

> Beware: This tutorial is about the **webpack version 5**. If you use version 4 or older some of the information in this guide will be incorrect! After installation (see below) you can check which version of webpack you have installed by looking into your `package.json` or running this command: `npm list --depth=0 | findstr webpack`. If you're using webpack 4 I highly recommend upgrading to 5.

# Requirements

## npm

We will be installing webpack with npm. This means you need node / npm installed on your device, and your project needs to be inialized as an npm project (= you need to have a `package.json` file in your root folder).

TUTORIAL LINK TODO

You also need to be able to use a command line / terminal. The tutorial link above will also teach you how to do that.

If your project is a git repository make sure that `node_modules` is in your `.gitignore` file. (See tutorial HERE LINK).

## SCSS

We will be using **SCSS** in this tutorial, so you need to know how it works.

If you don't know SCSS yet, here's a quick explanation: SCSS is a CSS preprocessor. We will use Webpack to turn SCSS code (`.scss`) into valid CSS code (`.css`), which you will upload to your website like normally. **Any valid CSS code is valid SCSS code, so you don't need to learn anything new!** But SCSS also gives you more freedom to write CSS code, such as nesting rules, variables, functions and other re-usable code, for loops, etc.

[Here](https://sass-lang.com/guide/) is a great tutorial with which you can learn the basics in just 10 minutes (Read the sections "Variables" and "Nesting", all others are optional).

Show SCSS Example TODO

Here is a simple, realistic SCSS example:

```scss
$font: Helvetica, Arial;
$textColor: black;
$linkColor: #333333;

body {
  font: $font;
  color: $textColor;
  font-size: 14px;
}

a {
  color: $linkColor;

  b {
    text-decoration: underline;
  }

  &:hover {
    color: darken($linkColor, 1.2);
  }
}
```

This would be turned into this CSS by Webpack:

```css
body {
  font: Helvetica, Arial;
  color: black;
  font-size: 14px;
}

a {
  color: #333333;
}

a b {
  text-decoration: underline;
}

a:hover {
  color: #303030;
}
```

# Project Structure

Our project is going to have a structure like this:

```
/dist
	- index.html	<- your home page
	- generated files...
/src
	- css/	<- your (s)css files are in here
		example.(s)css
	- js/	<- your javascript files are in here
		example.js
	- img/	<- your images are in here
	- fonts/	<- your fonts are in here
	- index.js	<- your entry javascript file (which loads all others)
	- main.scss	<- your entry scss file (which loads all others)
.gitignore
package-lock.json
package.json
webpack.config.js
```

Explanation:

- Your `dist` folder (short for "distribution") includes all files that the browser of a user visiting your site will be able to see and use, including all of your html files. By default, webpack's generated javascript file will be placed directly in this folder. (Alternatively, you could call this folder `public` if you prefer.)
  - The `/dist/index.html` file will be your homepage. You should create this one now.
- Your `src` folder (short for "source") includes all files that are only necessary for development, for example the javascript and CSS files that webpack will 'swallow up': Since they will be included in the file generated by webpack these files themselves do not need to be loaded by the browser. This also means you don't have to upload the contents of this folder to your website!
  - The `/src/index.js` will be your main javascript file, in which you will load all your other javascript files (see "Usage" below).
- `webpack.config.js` is the configuration file of webpack. This is where we tell webpack how to do what.

If you don't know the files `.gitignore`, `package-lock.json` and `package.json`, read my npm tutorial LINK TODO.

# Installation

Run `npm install --save-dev webpack webpack-cli` in your project folder to install webpack.

This will install the following packages:

- _webpack_
- _webpack-cli_ (This makes it possible for us to use the command line interface for webpack)

You should now see a new folder and file in your project:

The packages will be added to the dependency list in your `package.json`. Also, if you didn't have them before, a `node_modules` folder and a `package-lock.json` file will be generated. **You should never manually change the contents of `node_modules` or `package-lock.json`!** More information about that HERE TODO.

## CSS

Now, run this to install all required packages for handling CSS and SCSS:

`npm install --save-dev css-loader style-loader sass-loader sass mini-css-extract-plugin`

This will install the following packages:

- _css-loader_ (To interpret @import and url() in CSS files.)
- _style-loader_ (To inject CSS into the DOM.) (Optional)
- _sass-loader_ (To compile SCSS to CSS.)
- _sass_ (A requirement for _sass-loader_.)
- _mini-css-extract-plugin_ (Extracts CSS into separate files)

You don't need _sass-loader_ and _sass_ if you don't use SCSS; However, I **highly** recomennd using SCSS.

# Configuration

The configuration file is the file in which you tell webpack what to do and how.

Create a file `webpack.config.js` in your root folder. Webpack will automatically detect and use this configuration file.

The most minimal settings could look like this:

```js
const path = require("path");

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "main.js",
    path: path.resolve(__dirname, "dist"),
  },
  module: {
    rules: [],
  },
};
```

**Explanation:**

- `entry` defines your main javascript file which webpack should load. Your main javascript file is the one that loads all others. The default is _/src/index.js_ .
- `output` defines where webpack should save the generated file(s) (which will include your javascript, css, and so on). You can change the file name and path to your liking. The default is _/dist/main.js_
- `module.rules` is an array of rules which specify how webpack handles your files. We will add rules inside this array (= inside the `[]`) in the next step.

But we need more configuration than just this.

Here is a good starting point with most things already configured: (Paste it into your configuration file now.)

```js
const path = require("path");
const MiniCssExtractPlugin = require("mini-css-extract-plugin");

module.exports = {
  mode: "development",

  // Define entry file (which loads every other file):
  entry: "./src/index.js",

  // Define output file/directory:
  output: {
    filename: "main.js",
    path: path.resolve(__dirname, "dist"),
    assetModuleFilename: "assets/[path][name][ext]", // Preserve original file paths and file names for resources (images, fonts, etc.)
  },

  module: {
    rules: [
      // Rule for .css files:
      {
        test: /\.css$/i,
        use: [
          MiniCssExtractPlugin.loader, // extracts css into a file
          "css-loader", // necessary to load css
        ],
      },
      // Rule for .scss files:
      {
        test: /\.scss$/i,
        use: [
          MiniCssExtractPlugin.loader, // extracts css into a file
          "css-loader", // necessary to load css
          "sass-loader", // turns scss into css
        ],
      },
    ],
  },

  plugins: [
    // define name for generated css files:
    new MiniCssExtractPlugin({
      filename: "[name].css",
    }),
  ],

  // Generate source maps for easier debugging:
  devtool: "source-map",
};
```

> **Advanced Tip:** You can have multiple configuration files (e.g. for different purposes), but then you need to specify which one it should use, e.g. like this: `npm webpack --config webpack2.config.js`

## CSS directly in DOM

If you want your CSS code added into your head directly like this `<style>...</style>` instead of into a CSS file you will need to change your CSS and SCSS rules to this:

```js
  // Rule for .css files:
  {
    test: /\.css$/i,
    use: [
      "style-loader", // extracts css into a file
      "css-loader", // necessary to load css
    ],
  },
  // Rule for .scss files:
  {
    test: /\.scss$/i,
    use: [
      "style-loader", // extracts css into a file
      "css-loader", // necessary to load css
      "sass-loader", // turns scss into css
    ],
  },
```

Keep in mind that this will loading the styles of your website _slightly_ slower, so I don't recommend it unless you have a good reason.

# Usage

## CSS

Our `main.scss` could look like this:

```scss
body {
  font-size: 16px;
  color: green;
}

@import "css/example"; // imports the file "css/example.scss"
```

`css/example.scss`:

```scss
body {
  text-decoration: underline;
}
```

## JavaScript

Our `index.js` could look like this:

```js
import "./main.scss"; // loads all css
import { doExample } from "./js/example.js"; // loads the function doExample() from example.js

document.addEventListener("DOMContentLoaded", () => {
  document.body.innerHTML = "It works!";
  doExample();
});
```

`js/example.js`:

```
export function doExample() {
  console.log("This example works too!");
}
```

## Running Webpack

We'll now see if everything works so far.

Run `npx webpack` to **build your files**, or...

Run `npx webpack --watch` to **watch your files**. (This means they will automatically build if you change any of them, and is very practical when working on your project.)

> Note that these commands start with npX, not npM!

> **Remember these two commands!** You will use them every time you work on your project!

A javascript file (and, later, perhaps other asset files once you've configured them) will be generated in your `dist` folder.

## HTML

In your page file (located in your dist folder), you need to use the generated javascript css files (also located in your dist folder), and you do this like always:

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Webpack Example</title>
    <!-- loading javascript file: -->
    <script src="main.js"></script>
    <!-- loading css file: -->
    <link rel="stylesheet" href="main.css" />
  </head>
  <body>
    Hello World.
  </body>
</html>
```

(As usual, you might have to use `../`, `../../` etc. depending on the folder depth of your page file.)

## Done!

Everything should work now! Didn't work? TODO SUMMARY

- Make sure you've added the line inserting the "It works!" into your `index.js`
- Make sure you're loading your `main.js` (**not** the `index.js`) in your html file.
- If your html file is in a subfolder instead of directly in the `dist` folder, make sure to adjust the path to the `main.js`, e.g. `<script src="../main.js"></script>`
- Run the command `npm webpack -v` to make sure webpack is installed correctly. The command - if everything is correct - should display your webpack version.
- Remember to either run `npm webpack --watch` or `npx webpack`. If you're using `npx webpack` you need to run the command after every change you make in your javascript/css files.

# FAQ

- **I can't see my changes!** Make sure you run `npx webpack` after every change, or run `npx webpack --watch` so that webpack detects all changes automatically. Whenever you re-open your project you will need to run it again.
- **How do I stop the currently running command?** It depends on your IDE. In VSCode make sure you're focusing the terminal and press Ctrl+C (as if copying something).

Possible errors messages: (Always check your terminal and your browser's console!)

- **"Module build failed. [...] Cannot find module '...'"** You have probably added a configuration for a loader to your `webpack.config.js` without actually executing the command that installs said loader.
- **"Module parse failed. [...] You may need an appropriate loader to handle this file type..."** This means exactly what it says. You're probably trying to import/use a SCSS file, image or font file for which you have not finished (correctly) installing the 'loader'. Make sure to follow tutorial exactly. Keep in mind that you need the css-loader and the rule for `.css` files even if you only have `.scss` files in your project! ALSO MAKE SURE YOU HAVE THE RULE IN THE webpack.config.js !
- **"Uncaught SyntaxError: import declarations may only appear at top level of a module"** Make sure you are editing the javascript file in your `src` folder, not the one in the `dist` folder (that one you should never edit because it will be overwritten!)
  s

# Links

TODO
